From cf88ded432cb69b1ee83d4b49e7e5a40211e5c29 Mon Sep 17 00:00:00 2001
From: BraulioV <brauliovl95@gmail.com>
Date: Mon, 4 May 2020 14:17:16 +0200
Subject: [PATCH 1/2] Changed cgi.escape to html.escape. Fixes
 wolever/pip2pi#96

---
 libpip2pi/commands.py | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/libpip2pi/commands.py b/libpip2pi/commands.py
index 65d6cde..3e95528 100644
--- a/libpip2pi/commands.py
+++ b/libpip2pi/commands.py
@@ -1,7 +1,6 @@
 import os
 import re
 import sys
-import cgi
 import shutil
 import atexit
 import tempfile
@@ -12,6 +11,7 @@
 import pkg_resources
 import glob
 import optparse
+from html import escape
 
 try:
     import wheel as _; _
@@ -374,15 +374,15 @@ def _dir2pi(option, argv):
 
         if pkg_name not in processed_pkg:
             pkg_index += "<a href='%s/'>%s</a><br />\n" %(
-                cgi.escape(pkg_dir_name),
-                cgi.escape(pkg_name),
+                escape(pkg_dir_name),
+                escape(pkg_name),
             )
             processed_pkg.add(pkg_name)
 
         if option.build_html:
             with open(os.path.join(pkg_dir, "index.html"), "a") as fp:
                 fp.write("<a href='%(name)s'>%(name)s</a><br />\n" %{
-                    "name": cgi.escape(pkg_basename),
+                    "name": escape(pkg_basename),
                 })
     pkg_index += "</body></html>\n"
 

From 29b06984d497fd99144a008fa97dbbc176bf779f Mon Sep 17 00:00:00 2001
From: BraulioV <brauliovl95@gmail.com>
Date: Mon, 4 May 2020 15:25:56 +0200
Subject: [PATCH 2/2] Improved compatibility with old Python's versions and
 PyPy

---
 libpip2pi/commands.py | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/libpip2pi/commands.py b/libpip2pi/commands.py
index 3e95528..864b6ec 100644
--- a/libpip2pi/commands.py
+++ b/libpip2pi/commands.py
@@ -11,7 +11,11 @@
 import pkg_resources
 import glob
 import optparse
-from html import escape
+
+try:
+    from html import escape
+except ImportError:
+    from cgi import escape
 
 try:
     import wheel as _; _
